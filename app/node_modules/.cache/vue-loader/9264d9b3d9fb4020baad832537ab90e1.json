{"remainingRequest":"/Users/zoulan/Desktop/web-learn-static/vue/2020-08-15-vue-04/作业/app/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zoulan/Desktop/web-learn-static/vue/2020-08-15-vue-04/作业/app/src/views/Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zoulan/Desktop/web-learn-static/vue/2020-08-15-vue-04/作业/app/src/views/Main.vue","mtime":1598188141552},{"path":"/Users/zoulan/Desktop/web-learn-static/vue/2020-08-15-vue-04/作业/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zoulan/Desktop/web-learn-static/vue/2020-08-15-vue-04/作业/app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zoulan/Desktop/web-learn-static/vue/2020-08-15-vue-04/作业/app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zoulan/Desktop/web-learn-static/vue/2020-08-15-vue-04/作业/app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEl0ZW1zIH0gZnJvbSAiQC9hcGkvaW5kZXguanMiOwoKaW1wb3J0IHByaWNlIGZyb20gIkAvZmlsdGVycy9wcmljZS5qcyI7CmltcG9ydCBQYWdpbmF0aW9uIGZyb20gIkAvY29tcG9uZW50cy9QYWdpbmF0aW9uLnZ1ZSIKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNYWluIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXRlbUxpc3Q6IFtdLAogICAgICBwYWdlOjEsCiAgICAgIHRvdGFsOjAsCiAgICAgIHByZXBhZ2U6MTAKICAgIH07CiAgfSwKICBmaWx0ZXJzOiB7CiAgICBwcmljZSwKICB9LAogIGNvbXBvbmVudHM6ewogICAgUGFnaW5hdGlvbgogIH0sCiAgYXN5bmMgY3JlYXRlZCgpIHsKICAgICAgY29uc29sZS5sb2codGhpcy4kcm91dGUucXVlcnkpCiAgICAgICBsZXQgcnMgPWF3YWl0IGdldEl0ZW1zKCk7CiAgICAgICBjb25zb2xlLmxvZyhycykKICAgIC8vIGxldCB7ZGF0YTp7aXRlbXMscGFnZSx0b3RhbCxwcmVwYWdlfX0gPSBhd2FpdCBnZXRJdGVtcygpOwogICAgLy8gIHRoaXMuaXRlbUxpc3QgPSBpdGVtczsKICAgICBsZXQgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKQogICAgIGNvbnNvbGUubG9nKHRva2VuKQogICAgLy/liKTmlq3mmK/lkKbnmbvlvZXkuobvvIzmsqHmnInnmbvlvZXkuobot7PliLDnmbvlvZXpobXvvIznmbvlvZXkuoblsLHmmL7npLoKICAgIC8vIGxldCBpc0xvZ2luID0gdHJ1ZTsKICAgIGlmICh0b2tlbikgewogICAgICAgIGF3YWl0IHRoaXMuZ2V0SXRlbSgpOwogIAogICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6J0xvZ2luJwogICAgICAgIH0pCiAgICB9CiAgfSwKICAgIHdhdGNoOiB7CiAgICAgIGFzeW5jICRyb3V0ZSgpIHsKICAgICAgICBjb25zb2xlLmxvZygn5Y+Y5LqGJyk7CiAgICAgICAgYXdhaXQgdGhpcy5nZXRJdGVtKCk7CiAgICAgIH0KICAgIH0sCiAgbWV0aG9kczp7CiAgICAgIGNoYW5nZVBhZ2UocCl7CiAgICAgICAgY29uc29sZS5sb2coIueCueWHu+eahOS6i+S7tiIscCx0aGlzLnBhZ2UpCiAgICAgICAgLy8gaWYocCE9PXRoaXMucGFnZSl7CiAgICAgICAgICAgIC8v6YeN5paw5Y+R6YCB6K+35rGCCiAgICAgICAgLy8gICAgdGhpcy5nZXRJdGVtKCk7CiAgICAgICAgLy8gfQoKICAgICAgICAvL+mAmui/h3F1ZXJ5U3RyaW5n5pS55Y+Y5b2T5YmN6aG16Z2i55qEdXJsCiAgICAgICAgLy/lpoLmnpzkuKTmrKHot6/nlLHot7PovaznmoTmmK/lkIzkuIDkuKrnu4Tku7bvvIzov5nkuKrmmK/kuI3kvJrplIDmr4Hph43lu7rnmoTvvIzmmK/kvJrlpI3nlKjljp/mnaXnmoTvvIxjcmVhdGUoKeeUn+WRveWRqOacn+aYr+S4jeS8muaJp+ihjOeahAogICAgICAgIC8vICRyb3V0ZXI6IOWunumZheS4iuWwseaYryBuZXcgVnVlUm91dGVyIOW+l+WIsOeahOWvueixoe+8jOWug+S7o+ihqOadpeaVtOS4quW6lOeUqOeahOi3r+eUseS/oeaBr++8jOaPkOS+m+i3r+eUseWFrOeUqOeahOmFjee9ruS/oeaBr+WSjOaWueazle+8jOavlOWmgiBwdXNoCiAgICAgICAgLy8gJHJvdXRlOiDmu6HotrPlvZPliY11cmzogIzliJvlu7rnmoTkuIDkuKrlr7nosaHvvIzov5nkuKrlr7nooajph4zpnaLlrZjlgqjkuI7lvZPliY11cmzljLnphY3nmoTot6/nlLHkv6Hmga8KICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgIG5hbWU6J01haW4nLAogICAgICAgICAgICBxdWVyeTp7CiAgICAgICAgICAgICAgICBwYWdlOnAKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0sCiAgICAgIGFzeW5jIGdldEl0ZW0oKXsKICAgICAgICAvLyAgIHRoaXMucGFnZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnBhZ2UKICAgICAgICAgIGNvbnNvbGUubG9nKCIrKyvku47ot6/nlLHkuK3mi7/liLDnmoRwYWdlKysrIix0aGlzLiRyb3V0ZS5xdWVyeS5wYWdlKQogICAgICAgICAgdGhpcy5wYWdlID0gcGFyc2VJbnQodGhpcy4kcm91dGUucXVlcnkucGFnZSl8fDEKICAgICAgICAvL+ivt+axguWujOaIkOS5i+WJje+8jE1haW7nu4Tku7blrp7pmYXlt7Lnu4/kuIvmuLLmn5PkuoYKICAgICAgICBsZXQgewogICAgICAgICAgICBkYXRhOiB7IGl0ZW1zLHBhZ2UsdG90YWwscHJlcGFnZX0sCiAgICAgICAgfSA9IGF3YWl0IGdldEl0ZW1zKHsKICAgICAgICAgICAgcGFnZTp0aGlzLnBhZ2UsCiAgICAgICAgICAgIHByZXBhZ2U6dGhpcy5wcmVwYWdlCiAgICAgICAgfSk7CiAgICAgICAgICAgIC8v5b2T5pWw5o2u5Y+R55Sf5Y+Y5YyW5LmL5ZCO77yMTWFpbue7hOS7tumHjeaWsOa4suafk+S4gOasoQogICAgICAgIHRoaXMuaXRlbUxpc3QgPSBpdGVtczsKICAgICAgICB0aGlzLnBhZ2U9cGFnZTsKICAgICAgICB0aGlzLnRvdGFsID0gdG90YWw7CiAgICAgICAgdGhpcy5wcmVwYWdlID0gcHJlcGFnZTsKICAgICAgfQogIH0KfTsK"},{"version":3,"sources":["Main.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Main.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div id=\"main\">\n    <ul class=\"items-list\">\n      <router-link\n        :to=\"{ name: 'Detail', params: { id: item.id } }\"\n        class=\"panel\"\n        v-for=\"item of itemList\"\n        :key=\"item.id\"\n        tag=\"li\"\n      >\n        <!-- <router-link to='/detail/1'> -->\n        <img :src=\"item.cover\" alt=\"\" class=\"cover\" />\n        <!-- </router-link> -->\n        <div class=\"name\">{{ item.name }}</div>\n        <div class=\"price\">{{ item.price | price }}</div>\n      </router-link>\n    </ul>\n\n    <div class=\"pagination-container\">\n         <!-- <div class=\"pagination\">\n        <a href class=\"prev\">上一页</a>\n        <a href>1</a>\n        <a href>2</a>\n        <a href>3</a>\n        <a href class=\"current\">4</a>\n        <a href>5</a>\n        <a href>6</a>\n        <a href>7</a>\n        <a href>8</a>\n        <a href class=\"next\">下一页</a>\n      </div> -->\n     <Pagination :page='page' :total='total' :prepage='prepage' @change=\"changePage\"></Pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getItems } from \"@/api/index.js\";\n\nimport price from \"@/filters/price.js\";\nimport Pagination from \"@/components/Pagination.vue\"\nexport default {\n  name: \"Main\",\n  data() {\n    return {\n      itemList: [],\n      page:1,\n      total:0,\n      prepage:10\n    };\n  },\n  filters: {\n    price,\n  },\n  components:{\n    Pagination\n  },\n  async created() {\n      console.log(this.$route.query)\n       let rs =await getItems();\n       console.log(rs)\n    // let {data:{items,page,total,prepage}} = await getItems();\n    //  this.itemList = items;\n     let token = localStorage.getItem('token')\n     console.log(token)\n    //判断是否登录了，没有登录了跳到登录页，登录了就显示\n    // let isLogin = true;\n    if (token) {\n        await this.getItem();\n  \n    } else {\n        this.$router.push({\n            name:'Login'\n        })\n    }\n  },\n    watch: {\n      async $route() {\n        console.log('变了');\n        await this.getItem();\n      }\n    },\n  methods:{\n      changePage(p){\n        console.log(\"点击的事件\",p,this.page)\n        // if(p!==this.page){\n            //重新发送请求\n        //    this.getItem();\n        // }\n\n        //通过queryString改变当前页面的url\n        //如果两次路由跳转的是同一个组件，这个是不会销毁重建的，是会复用原来的，create()生命周期是不会执行的\n        // $router: 实际上就是 new VueRouter 得到的对象，它代表来整个应用的路由信息，提供路由公用的配置信息和方法，比如 push\n        // $route: 满足当前url而创建的一个对象，这个对表里面存储与当前url匹配的路由信息\n        this.$router.push({\n            name:'Main',\n            query:{\n                page:p\n            }\n        })\n      },\n      async getItem(){\n        //   this.page = this.$route.query.page\n          console.log(\"+++从路由中拿到的page+++\",this.$route.query.page)\n          this.page = parseInt(this.$route.query.page)||1\n        //请求完成之前，Main组件实际已经下渲染了\n        let {\n            data: { items,page,total,prepage},\n        } = await getItems({\n            page:this.page,\n            prepage:this.prepage\n        });\n            //当数据发生变化之后，Main组件重新渲染一次\n        this.itemList = items;\n        this.page=page;\n        this.total = total;\n        this.prepage = prepage;\n      }\n  }\n};\n</script>\n<style></style>\n"]}]}